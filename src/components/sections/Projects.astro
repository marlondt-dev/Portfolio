---
import typescript from 'icons/typescript.astro'
import nuxt from 'icons/nuxt.astro'
import Sass from 'icons/Sass.astro'
import Section from "../Section.astro";
import type {CV} from  '@/types/cv'
import {getI18N } from '@/i18n/utils'
import html from 'icons/html.astro'
import css from 'icons/css.astro'




interface Props {
  cv: CV,
  locale?: string
}

const {cv, locale = 'es'}: Props = Astro.props
const { projects } = cv
const i18n = getI18N (locale)

const TECH_ICONS: Record<string, any> = {
  TypeScript: typescript,
  NuxtJS: nuxt,
  Sass,
  HTML: html,
  CSS: css
}

---

<Section title={i18n.sections.projects}>
  <ul>
    {
      projects.map(({ name, url, description, highlights, isActive, technologies }) => {
        return (
          <li>
            <article>
              <header>
                <h3>
                <a href={`${url}`} title={ `Ir al proyecto ${name}`} target="_blank">
                 {name}
                </a>
                {
                  isActive && <span>&bull;</span>
                }
                </h3>
                <p>{description}</p>
                <div>
           <ul class="technologies">
            {
                               technologies &&  technologies.map((tech) => {
                                    const Icon = TECH_ICONS[tech];
                                    return (
                                        <span class="tech-item">
                                            {Icon && <Icon/>} 
                                        </span>
                                    )
                                })
                            }
           </ul>
                </div>
              </header>
              <footer>
                
                    {
                        highlights.map((highlight) => {
                            return (
                                <span>{highlight}</span>
                            )
                        })
                    }
                
              </footer>
            </article>
          </li>
        );
      })
    }
  </ul>
</Section>

<style>
    ul {
        margin-top: 0.5em;
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 0.8em;
    }

    span {
        font-size: 0.6em;
    }

    article {
        display: flex;
        flex-direction: column;
        gap: 1.5em;
        border-radius: 8px;
        border: 1px solid #f2f2f2;
        padding: 0.24em;
        height: 100%;
        padding: 0.8em 0.6em;
        
    }

    article header {
      flex: 1;
    }

    article a {
      color: #444;
    }

    article a:hover {
      text-decoration: underline;
    }

    article h3 {
      display: flex;
      flex-direction: row;
      gap: 0.5em;
      
    }


    article h3 span {
      color: rgb(3, 178, 82);
      font-size: 1em;
      
    }
    footer {
        display: flex;
        flex-wrap: wrap;
        gap: 0.4em;
    }

    footer span {
        background-color: #eee;
        padding: 0.3em 0.7em;
        border-radius: 4px;
        color: #444;
        font-weight: 500;
        font-size: 0.6em;
    }


     article p {
      font-size: 0.7rem;
      line-height: 1.4em;
     }

     .technologies {
      display: flex;
     }
</style>
